<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.95.0"><meta name=generator content="Relearn 3.4.1+tip"><meta name=description content><title>Github Actions :: jwoolbright.com</title><link href=/css/nucleus.css?1676920193 rel=stylesheet><link href=/css/fontawesome-all.min.css?1676920193 rel=stylesheet><link href=/css/featherlight.min.css?1676920193 rel=stylesheet><link href=/css/perfect-scrollbar.min.css?1676920193 rel=stylesheet><link href=/css/auto-complete.css?1676920193 rel=stylesheet><link href=/css/theme.css?1676920193 rel=stylesheet><link href=/css/theme-blue.css?1676920193 rel=stylesheet id=variant-style><link href=/css/variant.css?1676920193 rel=stylesheet><link href=/css/print.css?1676920193 rel=stylesheet media=print><script src=/js/variant.js?1676920193></script>
<script>var index_url="/index.json",baseUriFull,root_url="/",baseUri=root_url.replace(/\/$/,'');window.T_Copy_to_clipboard="Copy to clipboard",window.T_Copied_to_clipboard="Copied to clipboard!",window.T_Copy_link_to_clipboard="Copy link to clipboard",window.T_Link_copied_to_clipboard="Copied link to clipboard!",baseUriFull="https://jwoolbright.com/",variants.init(["blue","green","neon"])</script><script src=/js/jquery.min.js?1676920193></script></head><body class=mobile-support data-url=/learning/github-actions/><div id=body class=default-animation><div id=sidebar-overlay></div><div id=toc-overlay></div><nav id=topbar class=highlightable><div><div class=navigation><span class="nav nav-next"><i class="fa fa-chevron-right fa-fw"></i></span></div><div class=navigation><a class="nav nav-prev" href=/learning/terraform/terraform-aws/ title="Infrastructure with AWS"><i class="fas fa-chevron-left fa-fw"></i></a></div><div id=breadcrumbs><span id=sidebar-toggle-span><a href=# id=sidebar-toggle title=Menu><i class="fas fa-bars fa-fw"></i></a></span>
<span id=toc-menu title="Table of Contents"><i class="fas fa-list-alt fa-fw"></i></span><ol class=links itemscope itemtype=http://schema.org/BreadcrumbList><meta itemprop=itemListOrder content="Descending"><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="3"><a itemprop=item href=/><span itemprop=name>Home</span></a> ></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="2"><a itemprop=item href=/learning/><span itemprop=name>Current Studies</span></a> ></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="1"><a itemprop=item href=/learning/github-actions/ aria-disabled=true><span itemprop=name>Github Actions</span></a></li></ol></div><div class="default-animation progress"><div class=wrapper><nav id=TableOfContents><ul><li><a href=#description>Description</a></li><li><a href=#github-action-yml-file-for-project>Github Action .yml file for project:</a></li><li><a href=#troubleshooting>Troubleshooting</a></li></ul></nav></div></div></div></nav><main id=body-inner class=highlightable><div class=flex-block-wrapper><div id=head-tags></div><article><h1>Github Actions</h1><h2 id=description>Description</h2><p>I wanted to learn a bit more about CI/CD and landed on working through Github Actions so that I could incorporate it into this project.</p><p>The reason I decided on Github actions was simply because of the seamless integration within github. I plan on working through more ci/cd tools in the future but this was a good start and learning experience for me.</p><p>What I wanted to accomplish:</p><ol><li>Perform action on merge into master branch</li><li>Have the action complete the following tasks:<ul><li>Checkout master branch</li><li>Install framework on runner</li><li>Build project</li><li>Secure copy files to server</li></ul></li></ol><p>Requirements:</p><ul><li>Server hostname or ip address of production server</li><li>Username to login to server</li><li>ssh port (22)</li><li>Secret Key</li><li>Target directory on server</li></ul><p>All of the above information is stored inside of the project repository secrets. This allows you to use them as environment variables within the yml file that performs the action.</p><h2 id=github-action-yml-file-for-project>Github Action .yml file for project:</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=display:flex><span><span style=color:#75715e>## Name of action</span>
</span></span><span style=display:flex><span><span style=color:#f92672>name</span>: <span style=color:#ae81ff>Deploy Master on Merge</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>## When to perform the action</span>
</span></span><span style=display:flex><span><span style=color:#f92672>on</span>: 
</span></span><span style=display:flex><span>  <span style=color:#f92672>push</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>branches</span>:
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>master</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>## job content</span>
</span></span><span style=display:flex><span><span style=color:#f92672>jobs</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>dependencies_checkout_build_deliver</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Install Hugo, Checkout Source Code, Build Artifacts &amp; Deliver</span>
</span></span><span style=display:flex><span><span style=color:#75715e>## type of OS for runner</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>runs-on</span>: <span style=color:#ae81ff>ubuntu-latest</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>steps</span>:
</span></span><span style=display:flex><span><span style=color:#75715e>## checkout from master</span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Check out repository code</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>actions/checkout@master</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>with</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>submodules</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>fetch-depth</span>: <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span><span style=color:#75715e>## Install hugo on runner</span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Install Hugo</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>peaceiris/actions-hugo@v2</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>with</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>hugo-version</span>: <span style=color:#e6db74>&#39;0.93.0&#39;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>## build project on runner</span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Build</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>run</span>: <span style=color:#ae81ff>hugo --minify --gc</span>
</span></span><span style=display:flex><span><span style=color:#75715e>## deliver build artifacts to prod server</span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Deliver</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>appleboy/scp-action@master</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>with</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>host</span>: <span style=color:#ae81ff>${{ secrets.HOST }}</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>username</span>: <span style=color:#ae81ff>${{ secrets.USERNAME }}</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>port</span>: <span style=color:#ae81ff>${{ secrets.PORT }}</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>key</span>: <span style=color:#ae81ff>${{ secrets.KEY }}</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>source</span>: <span style=color:#e6db74>&#34;public/*&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>target</span>: <span style=color:#ae81ff>${{ secrets.PATH }}</span>
</span></span></code></pre></div><p>With a bit of research I was able to utilize some actions created by <code>peaceiris</code> and <code>appleboy</code>.</p><p>One complication throughout the process was the following error:</p><div class="box notices warning"><div class=box-label><i class="fas fa-exclamation-triangle fa-fw"></i> error</div><div class=box-content><p>error copy file to dest: ***, error message: ssh: handshake failed: ssh: unable to authenticate, attempted methods [none publickey], no supported methods remain</p></div></div><h2 id=troubleshooting>Troubleshooting</h2><ol><li>Double check private key was copied correctly to secret field</li><li>Changing private key from OPENSSH to RSA</li><li>Specify that the key is created as a .pem file with a length of 4098 (similar to that of action repo)</li></ol><p>Fortunately I was able to troubleshoot with a co-worker that had a similar tech-stack project. I noticed that the production server they were using was Ubuntu 20.04 while I was using the newest Ubuntu 22.04 Jammy LTS.</p><p>After changing the version of my server from 22.04 to 20.04 the issue was resolved and the action fired off without problems.</p><p>Overall this was an excellent learning experience and a good foot forward towards further automation.</p><footer class=footline></footer></article></div></main></div><aside id=sidebar class=default-animation><div id=header-wrapper class=default-animation><div id=header class=default-animation><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M201.5 305.5c-13.8.0-24.9-11.1-24.9-24.6.0-13.8 11.1-24.9 24.9-24.9 13.6.0 24.6 11.1 24.6 24.9.0 13.6-11.1 24.6-24.6 24.6zM504 256c0 137-111 248-248 248S8 393 8 256 119 8 256 8s248 111 248 248zm-132.3-41.2c-9.4.0-17.7 3.9-23.8 10-22.4-15.5-52.6-25.5-86.1-26.6l17.4-78.3 55.4 12.5c0 13.6 11.1 24.6 24.6 24.6 13.8.0 24.9-11.3 24.9-24.9s-11.1-24.9-24.9-24.9c-9.7.0-18 5.8-22.1 13.8l-61.2-13.6c-3-.8-6.1 1.4-6.9 4.4l-19.1 86.4c-33.2 1.4-63.1 11.3-85.5 26.8-6.1-6.4-14.7-10.2-24.1-10.2-34.9.0-46.3 46.9-14.4 62.8-1.1 5-1.7 10.2-1.7 15.5.0 52.6 59.2 95.2 132 95.2 73.1.0 132.3-42.6 132.3-95.2.0-5.3-.6-10.8-1.9-15.8 31.3-16 19.8-62.5-14.9-62.5zM302.8 331c-18.2 18.2-76.1 17.9-93.6.0-2.2-2.2-6.1-2.2-8.3.0-2.5 2.5-2.5 6.4.0 8.6 22.8 22.8 87.3 22.8 110.2.0 2.5-2.2 2.5-6.1.0-8.6-2.2-2.2-6.1-2.2-8.3.0zm7.7-75c-13.6.0-24.6 11.1-24.6 24.9.0 13.6 11.1 24.6 24.6 24.6 13.8.0 24.9-11.1 24.9-24.6.0-13.8-11-24.9-24.9-24.9z"/></svg></div><div class="searchbox default-animation"><label for=search-by><i class="fas fa-search"></i></label>
<input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script src=/js/lunr.min.js?1676920193></script>
<script src=/js/auto-complete.js?1676920193></script>
<script src=/js/search.js?1676920193></script></div><div id=homelinks class=default-animation><ul><li><a class=padding href=/><i class="fas fa-home"></i> Home</a></li></ul></div><div id=content-wrapper class=highlightable><ul class=topics><li data-nav-id=/project-work/ title="Project Work" class=dd-item><input type=checkbox id=section-9d9a852fec90c287c4dd3e7a53dd279f class=toggle><label for=section-9d9a852fec90c287c4dd3e7a53dd279f></label><a href=/project-work/>Project Work</a><ul><li data-nav-id=/project-work/scripting/ title=Scripting class=dd-item><a href=/project-work/scripting/>Scripting</a></li><li data-nav-id=/project-work/curriculum-development/ title="Curriculum Development" class=dd-item><a href=/project-work/curriculum-development/>Curriculum Development</a></li><li data-nav-id=/project-work/open-source/ title="Open Source Project Work" class="dd-item alwaysopen"><input type=checkbox id=section-3aa6bb7971555742c5d4a0f730bac82a class=toggle checked><label for=section-3aa6bb7971555742c5d4a0f730bac82a></label><a href=/project-work/open-source/>Open Source Project Work</a><ul><li data-nav-id=/project-work/open-source/open-source-starter-pack/ title="Starter Pack" class=dd-item><a href=/project-work/open-source/open-source-starter-pack/>Starter Pack</a></li><li data-nav-id=/project-work/open-source/open-source-collab-blog/ title="Collab Blog" class=dd-item><a href=/project-work/open-source/open-source-collab-blog/>Collab Blog</a></li></ul></li><li data-nav-id=/project-work/random-data-generator/ title="Random Data Generator" class=dd-item><a href=/project-work/random-data-generator/>Random Data Generator</a></li></ul></li><li data-nav-id=/learning/ title="Current Studies" class="dd-item parent"><input type=checkbox id=section-fe6fe8edae024729a4d37026612df035 class=toggle checked><label for=section-fe6fe8edae024729a4d37026612df035></label><a href=/learning/>Current Studies</a><ul><li data-nav-id=/learning/docker/ title=Docker class=dd-item><a href=/learning/docker/>Docker</a></li><li data-nav-id=/learning/terraform/ title=Terraform class="dd-item alwaysopen"><input type=checkbox id=section-77c8ed10dcb7e6f97ce06af0f0c1bde0 class=toggle checked><label for=section-77c8ed10dcb7e6f97ce06af0f0c1bde0></label><a href=/learning/terraform/>Terraform</a><ul><li data-nav-id=/learning/terraform/terraform-install/ title=Installation class=dd-item><a href=/learning/terraform/terraform-install/>Installation</a></li><li data-nav-id=/learning/terraform/terraform-aws/ title="Infrastructure with AWS" class=dd-item><a href=/learning/terraform/terraform-aws/>Infrastructure with AWS</a></li></ul></li><li data-nav-id=/learning/github-actions/ title="Github Actions" class="dd-item active"><a href=/learning/github-actions/>Github Actions</a></li></ul></li></ul><div id=shortcuts><div class=nav-title>More</div><ul><li><a class=padding href=https://github.com/jwoolbright23>Github Account</a></li></ul></div><div class="footermargin footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showVariantSwitch showFooter"></div><hr class="default-animation footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showVariantSwitch showFooter"><div id=prefooter class="footerLangSwitch footerVariantSwitch footerVisitedLinks showVariantSwitch"><ul><li id=select-language-container class=footerLangSwitch><a class="padding select-container"><i class="fas fa-language fa-fw"></i>
<span>&nbsp;</span><div class=select-style><select id=select-language onchange="location=baseUri+this.value"></select></div><div class=select-clear></div></a></li><li id=select-variant-container class="footerVariantSwitch showVariantSwitch"><a class="padding select-container"><i class="fas fa-paint-brush fa-fw"></i>
<span>&nbsp;</span><div class=select-style><select id=select-variant onchange=variants.changeVariant(this.value)><option id=blue value=blue selected>Blue</option><option id=green value=green>Green</option><option id=neon value=neon>Neon</option></select></div><div class=select-clear></div></a><script>variants.markSelectedVariant()</script></li><li class=footerVisitedLinks><a class=padding href=# data-clear-history-toggle><i class="fas fa-history fa-fw"></i> Clear History</a></li></ul></div><div id=footer class="footerFooter showFooter"></div></div></aside><script src=/js/clipboard.min.js?1676920193></script>
<script src=/js/perfect-scrollbar.min.js?1676920193></script>
<script src=/js/featherlight.min.js?1676920193></script>
<script src=/js/theme.js?1676920193></script></body></html>